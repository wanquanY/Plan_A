# é£ä¹¦é£æ ¼ç”»æ¿åŠŸèƒ½æŠ€æœ¯è®¾è®¡æ–‡æ¡£

## 1. æ¦‚è¿°

æœ¬é¡¹ç›®å®ç°ç±»ä¼¼é£ä¹¦æ–‡æ¡£çš„ä¸“ä¸šç”»æ¿åŠŸèƒ½ï¼Œæä¾›ç‹¬ç«‹çš„å…¨å±ç¼–è¾‘ç•Œé¢ï¼Œæ”¯æŒæµç¨‹å›¾ã€æ€ç»´å¯¼å›¾ã€æ•°æ®åº“è®¾è®¡å›¾ç­‰å¤šç§ä¸“ä¸šç»˜å›¾éœ€æ±‚ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡åŒå‡»ç”»æ¿è¿›å…¥ä¸“é—¨çš„ç¼–è¾‘ç¯å¢ƒï¼Œäº«å—ä¸é£ä¹¦ç”»æ¿ç›¸åŒçš„ä¸“ä¸šä½“éªŒã€‚

## 2. é£ä¹¦ç”»æ¿ç‰¹æ€§åˆ†æ

### 2.1 ç•Œé¢å¸ƒå±€ç‰¹ç‚¹
- **ç‹¬ç«‹å…¨å±ç¼–è¾‘**ï¼šåŒå‡»è¿›å…¥ä¸“é—¨çš„ç”»æ¿ç¼–è¾‘é¡µé¢ï¼Œæä¾›æ²‰æµ¸å¼ç¼–è¾‘ä½“éªŒ
- **å·¦ä¾§å·¥å…·é¢æ¿**ï¼šå‚ç›´å¸ƒå±€çš„ä¸°å¯Œå·¥å…·æ ï¼ŒåŒ…å«å½¢çŠ¶ã€ç´ æã€æ•°æ®å»ºæ¨¡ç­‰åˆ†ç±»
- **é¡¶éƒ¨åŠŸèƒ½æ **ï¼šé€€å‡ºã€ç”»æ¿è®¾ç½®ã€åˆ†äº«ã€å¯¼å‡ºç­‰å…¨å±€åŠŸèƒ½
- **ä¸»ç”»å¸ƒåŒºåŸŸ**ï¼šæ”¯æŒæ— é™ç”»å¸ƒã€ç½‘æ ¼èƒŒæ™¯ã€ç¼©æ”¾å¹³ç§»
- **å³ä¾§å±æ€§é¢æ¿**ï¼šåŠ¨æ€æ˜¾ç¤ºé€‰ä¸­å…ƒç´ çš„å±æ€§å’Œæ ·å¼è®¾ç½®

### 2.2 æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§
- **ä¸°å¯Œçš„å½¢çŠ¶åº“**ï¼šåŸºç¡€å›¾å½¢ã€æµç¨‹å›¾ç¬¦å·ã€æ•°æ®åº“å›¾æ ‡ã€ç½‘ç»œæ‹“æ‰‘ç­‰
- **ä¸“ä¸šè¿æ¥çº¿**ï¼šæ™ºèƒ½è·¯ç”±ã€è‡ªåŠ¨å¸é™„ã€å¤šç§ç®­å¤´æ ·å¼
- **æ•°æ®å»ºæ¨¡å·¥å…·**ï¼šERå›¾ã€UMLå›¾ã€ç»„ç»‡æ¶æ„å›¾ç­‰ä¸“ä¸šå›¾è¡¨
- **åä½œåŠŸèƒ½**ï¼šå¤šäººå®æ—¶ç¼–è¾‘ã€è¯„è®ºã€å†å²ç‰ˆæœ¬
- **æ™ºèƒ½è¾…åŠ©**ï¼šè‡ªåŠ¨å¯¹é½ã€æ™ºèƒ½å¸ƒå±€ã€æ¨¡æ¿æ¨è

### 2.3 æŠ€æœ¯æ ˆé€‰æ‹©

åŸºäºç°æœ‰æ¶æ„ï¼Œå‡çº§æŠ€æœ¯é€‰å‹ï¼š

- **æ¸²æŸ“å¼•æ“**: Konva.js (ä¸»è¦) + Fabric.js (è¾…åŠ©)
- **å…¨å±ç•Œé¢**: Vue 3 Router + ç‹¬ç«‹è·¯ç”±é¡µé¢
- **UIæ¡†æ¶**: Ant Design Vue + è‡ªå®šä¹‰ç»„ä»¶
- **çŠ¶æ€ç®¡ç†**: Pinia + å®æ—¶åŒæ­¥
- **å›¾å½¢åº“**: è‡ªå®šä¹‰SVGå›¾æ ‡åº“ + ä¸“ä¸šç¬¦å·åº“
- **å¯¼å‡ºå¼•æ“**: html2canvas + jsPDF + SVG

## 3. æ¶æ„è®¾è®¡é‡æ„

### 3.1 å…¨å±ç¼–è¾‘ç•Œé¢æ¶æ„

#### 3.1.1 è·¯ç”±è®¾è®¡
```typescript
// è·¯ç”±é…ç½®
{
  path: '/canvas/:canvasId/edit',
  name: 'CanvasFullscreenEditor',
  component: () => import('@/components/Canvas/FullscreenEditor/index.vue'),
  meta: { 
    fullscreen: true,
    requiresAuth: true 
  }
}

// ä»åµŒå…¥ç”»æ¿è¿›å…¥å…¨å±ç¼–è¾‘
const enterFullscreenEdit = (canvasId: string) => {
  // ä¿å­˜å½“å‰ç¼–è¾‘å™¨çŠ¶æ€
  await saveEditorState()
  // è·³è½¬åˆ°å…¨å±ç¼–è¾‘é¡µé¢
  router.push(`/canvas/${canvasId}/edit`)
}
```

#### 3.1.2 ç»„ä»¶ç»“æ„é‡æ„
```
components/Canvas/
â”œâ”€â”€ EmbeddedCanvas.vue           # åµŒå…¥å¼ç”»æ¿ç»„ä»¶ (ç®€åŒ–ç‰ˆ)
â”œâ”€â”€ FullscreenEditor/            # å…¨å±ç¼–è¾‘å™¨ (é£ä¹¦é£æ ¼)
â”‚   â”œâ”€â”€ index.vue               # ç¼–è¾‘å™¨ä¸»å®¹å™¨
â”‚   â”œâ”€â”€ TopBar/                 # é¡¶éƒ¨å·¥å…·æ 
â”‚   â”‚   â”œâ”€â”€ index.vue          # ä¸»å·¥å…·æ 
â”‚   â”‚   â”œâ”€â”€ FileActions.vue    # æ–‡ä»¶æ“ä½œ (ä¿å­˜/å¯¼å‡º/åˆ†äº«)
â”‚   â”‚   â”œâ”€â”€ ViewControls.vue   # è§†å›¾æ§åˆ¶ (ç¼©æ”¾/ç½‘æ ¼/å…¨å±)
â”‚   â”‚   â””â”€â”€ UndoRedoControls.vue # æ’¤é”€é‡åš
â”‚   â”œâ”€â”€ LeftSidebar/            # å·¦ä¾§å·¥å…·é¢æ¿
â”‚   â”‚   â”œâ”€â”€ index.vue          # ä¾§è¾¹æ å®¹å™¨
â”‚   â”‚   â”œâ”€â”€ ToolCategories.vue # å·¥å…·åˆ†ç±»å¯¼èˆª
â”‚   â”‚   â”œâ”€â”€ ShapeLibrary/      # å½¢çŠ¶åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ BasicShapes.vue    # åŸºç¡€å›¾å½¢
â”‚   â”‚   â”‚   â”œâ”€â”€ FlowchartShapes.vue # æµç¨‹å›¾ç¬¦å·
â”‚   â”‚   â”‚   â”œâ”€â”€ DatabaseShapes.vue  # æ•°æ®åº“å›¾æ ‡
â”‚   â”‚   â”‚   â”œâ”€â”€ NetworkShapes.vue   # ç½‘ç»œæ‹“æ‰‘
â”‚   â”‚   â”‚   â””â”€â”€ CustomShapes.vue    # è‡ªå®šä¹‰å›¾å½¢
â”‚   â”‚   â”œâ”€â”€ MaterialLibrary.vue # ç´ æåº“
â”‚   â”‚   â””â”€â”€ TemplateLibrary.vue # æ¨¡æ¿åº“
â”‚   â”œâ”€â”€ RightPanel/             # å³ä¾§å±æ€§é¢æ¿
â”‚   â”‚   â”œâ”€â”€ index.vue          # é¢æ¿å®¹å™¨
â”‚   â”‚   â”œâ”€â”€ ElementProperties.vue # å…ƒç´ å±æ€§
â”‚   â”‚   â”œâ”€â”€ StyleEditor.vue    # æ ·å¼ç¼–è¾‘å™¨
â”‚   â”‚   â”œâ”€â”€ LayerManager.vue   # å›¾å±‚ç®¡ç†
â”‚   â”‚   â””â”€â”€ HistoryPanel.vue   # å†å²è®°å½•
â”‚   â”œâ”€â”€ Canvas/                 # ç”»å¸ƒæ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ CanvasContainer.vue # ç”»å¸ƒå®¹å™¨
â”‚   â”‚   â”œâ”€â”€ CanvasRenderer.vue  # æ¸²æŸ“å¼•æ“
â”‚   â”‚   â”œâ”€â”€ GridBackground.vue  # ç½‘æ ¼èƒŒæ™¯
â”‚   â”‚   â”œâ”€â”€ SelectionBox.vue    # é€‰æ‹©æ¡†
â”‚   â”‚   â””â”€â”€ ContextMenu.vue     # å³é”®èœå•
â”‚   â””â”€â”€ StatusBar/              # åº•éƒ¨çŠ¶æ€æ 
â”‚       â”œâ”€â”€ index.vue          # çŠ¶æ€æ ä¸»ç»„ä»¶
â”‚       â”œâ”€â”€ ZoomControls.vue   # ç¼©æ”¾æ§åˆ¶
â”‚       â”œâ”€â”€ CoordinateDisplay.vue # åæ ‡æ˜¾ç¤º
â”‚       â””â”€â”€ ElementCounter.vue  # å…ƒç´ ç»Ÿè®¡
â”œâ”€â”€ Elements/                   # ç”»å¸ƒå…ƒç´ ç»„ä»¶
â”‚   â”œâ”€â”€ BaseElement.vue        # åŸºç¡€å…ƒç´ ç±»
â”‚   â”œâ”€â”€ Shape/                 # å½¢çŠ¶å…ƒç´ 
â”‚   â”‚   â”œâ”€â”€ Rectangle.vue      # çŸ©å½¢
â”‚   â”‚   â”œâ”€â”€ Circle.vue         # åœ†å½¢
â”‚   â”‚   â”œâ”€â”€ Diamond.vue        # è±å½¢
â”‚   â”‚   â”œâ”€â”€ Database.vue       # æ•°æ®åº“å›¾æ ‡
â”‚   â”‚   â””â”€â”€ CustomShape.vue    # è‡ªå®šä¹‰å½¢çŠ¶
â”‚   â”œâ”€â”€ Connection/            # è¿æ¥çº¿
â”‚   â”‚   â”œâ”€â”€ StraightLine.vue   # ç›´çº¿
â”‚   â”‚   â”œâ”€â”€ CurvedLine.vue     # æ›²çº¿
â”‚   â”‚   â”œâ”€â”€ FlowLine.vue       # æµç¨‹çº¿
â”‚   â”‚   â””â”€â”€ DataLine.vue       # æ•°æ®æµçº¿
â”‚   â”œâ”€â”€ Text/                  # æ–‡æœ¬å…ƒç´ 
â”‚   â”‚   â”œâ”€â”€ SimpleText.vue     # ç®€å•æ–‡æœ¬
â”‚   â”‚   â”œâ”€â”€ RichText.vue       # å¯Œæ–‡æœ¬
â”‚   â”‚   â””â”€â”€ Label.vue          # æ ‡ç­¾
â”‚   â””â”€â”€ Group/                 # ç»„åˆå…ƒç´ 
â”‚       â”œâ”€â”€ ElementGroup.vue   # å…ƒç´ ç»„
â”‚       â””â”€â”€ Template.vue       # æ¨¡æ¿å®ä¾‹
â”œâ”€â”€ Tools/                     # å·¥å…·ç³»ç»Ÿ
â”‚   â”œâ”€â”€ SelectTool.vue         # é€‰æ‹©å·¥å…·
â”‚   â”œâ”€â”€ DrawTool.vue           # ç»˜åˆ¶å·¥å…·
â”‚   â”œâ”€â”€ TextTool.vue           # æ–‡æœ¬å·¥å…·
â”‚   â”œâ”€â”€ ConnectorTool.vue      # è¿æ¥å·¥å…·
â”‚   â””â”€â”€ PanTool.vue            # å¹³ç§»å·¥å…·
â”œâ”€â”€ Stores/                    # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ canvasStore.ts         # ç”»å¸ƒçŠ¶æ€
â”‚   â”œâ”€â”€ toolStore.ts           # å·¥å…·çŠ¶æ€
â”‚   â”œâ”€â”€ elementStore.ts        # å…ƒç´ ç®¡ç†
â”‚   â”œâ”€â”€ selectionStore.ts      # é€‰æ‹©çŠ¶æ€
â”‚   â”œâ”€â”€ historyStore.ts        # å†å²è®°å½•
â”‚   â””â”€â”€ collaborationStore.ts  # åä½œçŠ¶æ€
â”œâ”€â”€ Utils/                     # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ geometry.ts            # å‡ ä½•è®¡ç®—
â”‚   â”œâ”€â”€ collision.ts           # ç¢°æ’æ£€æµ‹
â”‚   â”œâ”€â”€ export.ts              # å¯¼å‡ºåŠŸèƒ½
â”‚   â”œâ”€â”€ import.ts              # å¯¼å…¥åŠŸèƒ½
â”‚   â”œâ”€â”€ template.ts            # æ¨¡æ¿å¤„ç†
â”‚   â””â”€â”€ collaboration.ts       # åä½œå·¥å…·
â”œâ”€â”€ Types/                     # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ canvas.ts              # ç”»å¸ƒç±»å‹
â”‚   â”œâ”€â”€ elements.ts            # å…ƒç´ ç±»å‹
â”‚   â”œâ”€â”€ tools.ts               # å·¥å…·ç±»å‹
â”‚   â”œâ”€â”€ events.ts              # äº‹ä»¶ç±»å‹
â”‚   â””â”€â”€ api.ts                 # APIç±»å‹
â””â”€â”€ Assets/                    # é™æ€èµ„æº
    â”œâ”€â”€ icons/                 # å›¾æ ‡åº“
    â”œâ”€â”€ shapes/                # å½¢çŠ¶å®šä¹‰
    â”œâ”€â”€ templates/             # æ¨¡æ¿æ–‡ä»¶
    â””â”€â”€ themes/                # ä¸»é¢˜æ ·å¼
```

### 3.2 æ ¸å¿ƒæ•°æ®æ¨¡å‹è®¾è®¡

#### 3.2.1 ç”»å¸ƒæ•°æ®ç»“æ„
```typescript
interface CanvasDocument {
  id: string
  name: string
  description?: string
  thumbnail?: string
  
  // ç”»å¸ƒè®¾ç½®
  canvas: {
  width: number
  height: number
    background: BackgroundConfig
    grid: GridConfig
  zoom: number
    viewport: ViewportConfig
  }
  
  // å…ƒç´ æ•°æ®
  elements: CanvasElement[]
  connections: Connection[]
  groups: ElementGroup[]
  
  // ç‰ˆæœ¬ä¿¡æ¯
  version: string
  createdAt: Date
  updatedAt: Date
  createdBy: string
  lastModifiedBy: string
  
  // åä½œä¿¡æ¯
  collaborators: Collaborator[]
  permissions: PermissionConfig
  
  // å¯¼å‡ºè®¾ç½®
  exportSettings: ExportConfig
}

interface CanvasElement {
  id: string
  type: ElementType
  
  // å‡ ä½•å±æ€§
  geometry: {
  x: number
  y: number
  width: number
  height: number
  rotation: number
    anchor: AnchorPoint
  }
  
  // è§†è§‰æ ·å¼
  style: {
    fill: FillStyle
    stroke: StrokeStyle
    shadow: ShadowStyle
    opacity: number
    visible: boolean
  }
  
  // å…ƒç´ æ•°æ®
  data: any
  
  // è¿æ¥ç‚¹
  connectionPoints: ConnectionPoint[]
  
  // å…ƒæ•°æ®
  metadata: {
    locked: boolean
    groupId?: string
    layerId: string
    zIndex: number
    tags: string[]
  }
}

interface Connection {
  id: string
  type: ConnectionType
  
  // è¿æ¥ä¿¡æ¯
  source: {
    elementId: string
    connectionPointId: string
  }
  target: {
    elementId: string
    connectionPointId: string
  }
  
  // è·¯å¾„ä¿¡æ¯
  path: PathData
  style: ConnectionStyle
  
  // æ ‡ç­¾
  labels: ConnectionLabel[]
  
  // å…ƒæ•°æ®
  metadata: ConnectionMetadata
}
```

### 3.3 å…¨å±ç¼–è¾‘å™¨ç•Œé¢è®¾è®¡

#### 3.3.1 ä¸»ç•Œé¢å¸ƒå±€ (é£ä¹¦é£æ ¼)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â” ç”»æ¿ç¼–è¾‘å™¨                           ğŸ”„â†©ï¸ ğŸ’¾ ğŸ“¤ ğŸ‘¥ âŒ    â”‚ 
â”‚  â”‚ â† â”‚ è¿”å›æ–‡æ¡£                                                â”‚ é¡¶éƒ¨æ 
â”‚  â””â”€â”€â”€â”€â”€â”˜                                                      â”‚
â”œâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ ğŸ”² å›¾å½¢                                                     â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚ â”‚ ğŸ“„ ç´ æ                                                     â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚ â”‚ ğŸ—‚ï¸ æ•°æ®å»ºæ¨¡                                                 â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚ â”‚ ğŸ”§ æ—¶åºå›¾                                                    â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚ â”‚ ğŸ“š æ¨¡æ¿                                                     â”‚
â”‚ â”‚                                                            â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                â”‚
â”‚ â”‚ â”‚ çŸ©å½¢    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                             â”‚             â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚        ä¸»ç”»å¸ƒåŒºåŸŸ            â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”‚ åœ†å½¢    â”‚    â”‚                             â”‚ â”‚å±æ€§é¢æ¿  â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚     ğŸ“Š ğŸ”„ ğŸ’¾              â”‚ â”‚         â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                             â”‚ â”‚é¢œè‰²     â”‚ â”‚
â”‚ â”‚ â”‚ è±å½¢    â”‚    â”‚                             â”‚ â”‚å­—ä½“     â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                             â”‚ â”‚è¾¹æ¡†     â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                             â”‚ â”‚é˜´å½±     â”‚ â”‚
â”‚ â”‚ â”‚ æ•°æ®åº“   â”‚    â”‚                             â”‚ â”‚         â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                             â”‚ â”‚å›¾å±‚     â”‚ â”‚
â”‚ â”‚                â”‚                             â”‚ â”‚å†å²     â”‚ â”‚
â”‚ â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ” 100% â”‚ ç½‘æ ¼ â”‚ åæ ‡ (0, 0) â”‚ é€‰ä¸­ 3 ä¸ªå…ƒç´  â”‚ è‡ªåŠ¨ä¿å­˜    â”‚ çŠ¶æ€æ 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3.2 å·¦ä¾§å·¥å…·é¢æ¿è¯¦ç»†è®¾è®¡

##### å›¾å½¢å·¥å…·åˆ†ç±»
```typescript
const ShapeCategories = {
  basic: {
    name: 'åŸºç¡€å›¾å½¢',
    icon: 'ğŸ”²',
    shapes: [
      { type: 'rectangle', name: 'çŸ©å½¢', icon: 'â–­' },
      { type: 'circle', name: 'åœ†å½¢', icon: 'â—‹' },
      { type: 'diamond', name: 'è±å½¢', icon: 'â—‡' },
      { type: 'triangle', name: 'ä¸‰è§’å½¢', icon: 'â–³' },
      { type: 'pentagon', name: 'äº”è¾¹å½¢', icon: 'â¬Ÿ' },
      { type: 'hexagon', name: 'å…­è¾¹å½¢', icon: 'â¬¡' },
      { type: 'star', name: 'æ˜Ÿå½¢', icon: 'â˜†' },
      { type: 'arrow', name: 'ç®­å¤´', icon: 'â†’' }
    ]
  },
  
  flowchart: {
    name: 'æµç¨‹å›¾',
    icon: 'ğŸ“Š',
    shapes: [
      { type: 'process', name: 'å¤„ç†', icon: 'â–­' },
      { type: 'decision', name: 'åˆ¤æ–­', icon: 'â—‡' },
      { type: 'terminal', name: 'ç»ˆç«¯', icon: 'â–¯' },
      { type: 'document', name: 'æ–‡æ¡£', icon: 'ğŸ“„' },
      { type: 'database', name: 'æ•°æ®åº“', icon: 'ğŸ—ƒï¸' },
      { type: 'storage', name: 'å­˜å‚¨', icon: 'ğŸ›¢ï¸' }
    ]
  },
  
  database: {
    name: 'æ•°æ®å»ºæ¨¡',
    icon: 'ğŸ—‚ï¸',
    shapes: [
      { type: 'entity', name: 'å®ä½“', icon: 'ğŸ“‹' },
      { type: 'attribute', name: 'å±æ€§', icon: 'â—‹' },
      { type: 'relationship', name: 'å…³ç³»', icon: 'â—‡' },
      { type: 'table', name: 'è¡¨', icon: 'ğŸ“Š' },
      { type: 'view', name: 'è§†å›¾', icon: 'ğŸ‘ï¸' },
      { type: 'index', name: 'ç´¢å¼•', icon: 'ğŸ”' }
    ]
  },
  
  network: {
    name: 'ç½‘ç»œæ‹“æ‰‘',
    icon: 'ğŸŒ',
    shapes: [
      { type: 'server', name: 'æœåŠ¡å™¨', icon: 'ğŸ–¥ï¸' },
      { type: 'router', name: 'è·¯ç”±å™¨', icon: 'ğŸ“¡' },
      { type: 'switch', name: 'äº¤æ¢æœº', icon: 'ğŸ”Œ' },
      { type: 'firewall', name: 'é˜²ç«å¢™', icon: 'ğŸ›¡ï¸' },
      { type: 'cloud', name: 'äº‘æœåŠ¡', icon: 'â˜ï¸' },
      { type: 'user', name: 'ç”¨æˆ·', icon: 'ğŸ‘¤' }
    ]
  },
  
  uml: {
    name: 'UMLå›¾',
    icon: 'ğŸ“',
    shapes: [
      { type: 'class', name: 'ç±»', icon: 'ğŸ“¦' },
      { type: 'interface', name: 'æ¥å£', icon: 'ğŸ”Œ' },
      { type: 'actor', name: 'è§’è‰²', icon: 'ğŸ‘¤' },
      { type: 'usecase', name: 'ç”¨ä¾‹', icon: 'â—‹' },
      { type: 'component', name: 'ç»„ä»¶', icon: 'ğŸ“¦' },
      { type: 'node', name: 'èŠ‚ç‚¹', icon: 'ğŸ–¥ï¸' }
    ]
  }
}
```

#### 3.3.3 é¡¶éƒ¨å·¥å…·æ åŠŸèƒ½è®¾è®¡

```typescript
const TopBarActions = {
  navigation: {
    back: { icon: 'â†', title: 'è¿”å›æ–‡æ¡£', shortcut: 'Esc' },
    title: { text: 'ç”»æ¿åç§°', editable: true }
  },
  
  file: {
    save: { icon: 'ğŸ’¾', title: 'ä¿å­˜', shortcut: 'Ctrl+S' },
    export: { 
      icon: 'ğŸ“¤', 
      title: 'å¯¼å‡º',
      options: ['PNG', 'SVG', 'PDF', 'JSON']
    },
    import: {
      icon: 'ğŸ“¥',
      title: 'å¯¼å…¥',
      options: ['JSON', 'SVG', 'Visio', 'Draw.io']
    }
  },
  
  collaboration: {
    share: { icon: 'ğŸ‘¥', title: 'åˆ†äº«', action: 'openShareDialog' },
    comments: { icon: 'ğŸ’¬', title: 'è¯„è®º', badge: 3 },
    history: { icon: 'ğŸ•', title: 'å†å²ç‰ˆæœ¬' }
  },
  
  view: {
    undo: { icon: 'â†©ï¸', title: 'æ’¤é”€', shortcut: 'Ctrl+Z' },
    redo: { icon: 'â†ªï¸', title: 'é‡åš', shortcut: 'Ctrl+Y' },
    zoom: { icon: 'ğŸ”', title: 'ç¼©æ”¾', options: ['é€‚åˆçª—å£', '100%', '200%'] },
    fullscreen: { icon: 'â›¶', title: 'å…¨å±', shortcut: 'F11' }
  }
}
```

### 3.4 å…³é”®æŠ€æœ¯å®ç°

#### 3.4.1 å…¨å±æ¨¡å¼åˆ‡æ¢
```typescript
// ä»åµŒå…¥ç”»æ¿è¿›å…¥å…¨å±ç¼–è¾‘
class CanvasTransition {
  async enterFullscreen(canvasId: string) {
    // 1. ä¿å­˜å½“å‰ç¼–è¾‘å™¨çŠ¶æ€
    const editorState = await this.saveCurrentEditorState()
    
    // 2. è·å–ç”»å¸ƒæ•°æ®
    const canvasData = await this.loadCanvasData(canvasId)
    
    // 3. è®¾ç½®å…¨å±ç¼–è¾‘çŠ¶æ€
    this.setFullscreenMode(true)
    
    // 4. è·¯ç”±è·³è½¬
    await router.push({
      name: 'CanvasFullscreenEditor',
      params: { canvasId },
      query: { 
        returnTo: router.currentRoute.value.fullPath,
        editorState: btoa(JSON.stringify(editorState))
      }
    })
  }
  
  async exitFullscreen() {
    // 1. ä¿å­˜ç”»å¸ƒæ›´æ”¹
    await this.saveCanvasChanges()
    
    // 2. æ¢å¤ç¼–è¾‘å™¨çŠ¶æ€
    const returnTo = router.currentRoute.value.query.returnTo
    const editorState = JSON.parse(atob(router.currentRoute.value.query.editorState))
    
    // 3. è¿”å›åŸé¡µé¢
    await router.push(returnTo)
    await this.restoreEditorState(editorState)
    
    // 4. åˆ·æ–°åµŒå…¥ç”»æ¿
    this.refreshEmbeddedCanvas()
  }
}
```

#### 3.4.2 é«˜æ€§èƒ½æ¸²æŸ“å¼•æ“
```typescript
class CanvasRenderer {
  private konvaStage: Konva.Stage
  private fabricCanvas: fabric.Canvas
  private renderMode: 'konva' | 'fabric' = 'konva'
  
  constructor(container: HTMLDivElement) {
    // åˆå§‹åŒ–Konvaèˆå° (ä¸»è¦æ¸²æŸ“å¼•æ“)
    this.konvaStage = new Konva.Stage({
      container,
      width: container.offsetWidth,
      height: container.offsetHeight,
      draggable: true
    })
    
    // åˆå§‹åŒ–Fabricç”»å¸ƒ (å¤æ‚å›¾å½¢å’Œæ–‡æœ¬)
    this.fabricCanvas = new fabric.Canvas(null, {
      width: container.offsetWidth,
      height: container.offsetHeight,
      renderOnAddRemove: false
    })
    
    this.setupLayers()
    this.setupInteraction()
  }
  
  // æ™ºèƒ½æ¸²æŸ“æ¨¡å¼é€‰æ‹©
  selectRenderMode(element: CanvasElement) {
    if (element.type === 'text' || element.type === 'richText') {
      return 'fabric' // Fabricæ“…é•¿æ–‡æœ¬å¤„ç†
    }
    if (element.type === 'path' || element.type === 'freehand') {
      return 'fabric' // Fabricæ“…é•¿è·¯å¾„ç»˜åˆ¶
    }
    return 'konva' // Konvaæ“…é•¿å›¾å½¢æ¸²æŸ“å’ŒåŠ¨ç”»
  }
  
  // è™šæ‹ŸåŒ–æ¸²æŸ“ (å¤§é‡å…ƒç´ ä¼˜åŒ–)
  renderWithVirtualization(elements: CanvasElement[], viewport: Viewport) {
    const visibleElements = this.getVisibleElements(elements, viewport)
    const renderQueue = this.createRenderQueue(visibleElements)
    
    requestAnimationFrame(() => {
      this.batchRender(renderQueue)
    })
  }
}
```

#### 3.4.3 æ™ºèƒ½è¿æ¥ç³»ç»Ÿ
```typescript
class SmartConnectionSystem {
  private snapDistance = 10
  private connectionPoints: Map<string, ConnectionPoint[]> = new Map()
  
  // è‡ªåŠ¨æ£€æµ‹è¿æ¥ç‚¹
  detectConnectionPoints(element: CanvasElement): ConnectionPoint[] {
    const { x, y, width, height } = element.geometry
    
    // åŸºç¡€è¿æ¥ç‚¹ (ä¸Šä¸‹å·¦å³ä¸­å¿ƒ)
    const basicPoints = [
      { id: 'top', x: x + width/2, y, direction: 'up' },
      { id: 'right', x: x + width, y: y + height/2, direction: 'right' },
      { id: 'bottom', x: x + width/2, y: y + height, direction: 'down' },
      { id: 'left', x, y: y + height/2, direction: 'left' }
    ]
    
    // æ ¹æ®å…ƒç´ ç±»å‹æ·»åŠ ç‰¹æ®Šè¿æ¥ç‚¹
    const specialPoints = this.getSpecialConnectionPoints(element)
    
    return [...basicPoints, ...specialPoints]
  }
  
  // æ™ºèƒ½è·¯ç”±ç®—æ³•
  calculateSmartRoute(start: Point, end: Point, obstacles: CanvasElement[]): Point[] {
    // A*ç®—æ³•å¯»æ‰¾æœ€ä¼˜è·¯å¾„
    const pathfinder = new AStarPathfinder(obstacles)
    const waypoints = pathfinder.findPath(start, end)
    
    // è·¯å¾„å¹³æ»‘å¤„ç†
    return this.smoothPath(waypoints)
  }
  
  // è‡ªåŠ¨å¸é™„
  snapToNearbyPoints(point: Point): Point {
    const nearbyPoints = this.findNearbyConnectionPoints(point, this.snapDistance)
    
    if (nearbyPoints.length > 0) {
      const closest = nearbyPoints.reduce((prev, current) => 
        this.distance(point, current) < this.distance(point, prev) ? current : prev
      )
      return closest
    }
    
    return point
  }
}
```

## 4. ä¸“ä¸šåŠŸèƒ½å®ç°

### 4.1 å½¢çŠ¶åº“ç³»ç»Ÿ

#### 4.1.1 åŠ¨æ€å½¢çŠ¶åŠ è½½
```typescript
class ShapeLibraryManager {
  private shapeCache: Map<string, ShapeDefinition> = new Map()
  private customShapes: Map<string, CustomShape> = new Map()
  
  // å»¶è¿ŸåŠ è½½å½¢çŠ¶å®šä¹‰
  async loadShapeCategory(category: string): Promise<ShapeDefinition[]> {
    if (!this.shapeCache.has(category)) {
      const module = await import(`@/assets/shapes/${category}.ts`)
      this.shapeCache.set(category, module.default)
    }
    
    return this.shapeCache.get(category)!
  }
  
  // åˆ›å»ºå½¢çŠ¶å®ä¾‹
  createShape(type: string, options: ShapeOptions): CanvasElement {
    const definition = this.getShapeDefinition(type)
    
    return {
      id: generateId(),
      type,
      geometry: this.calculateGeometry(definition, options),
      style: this.applyDefaultStyle(definition),
      data: definition.defaultData || {},
      connectionPoints: this.generateConnectionPoints(definition),
      metadata: {
        locked: false,
        layerId: 'default',
        zIndex: this.getNextZIndex(),
        tags: definition.tags || []
      }
    }
  }
}
```

#### 4.1.2 è‡ªå®šä¹‰å½¢çŠ¶ç¼–è¾‘å™¨
```vue
<template>
  <div class="custom-shape-editor">
    <div class="shape-canvas">
      <svg :width="canvasSize.width" :height="canvasSize.height">
        <g v-for="path in shapePaths" :key="path.id">
          <path 
            :d="path.d" 
            :fill="path.fill" 
            :stroke="path.stroke"
            @click="selectPath(path)"
          />
        </g>
        <!-- ç¼–è¾‘æ§åˆ¶ç‚¹ -->
        <g v-if="selectedPath">
          <circle 
            v-for="point in editPoints" 
            :key="point.id"
            :cx="point.x" 
            :cy="point.y" 
            r="4"
            fill="#1890ff"
            @mousedown="startDragPoint(point)"
          />
        </g>
      </svg>
    </div>
    
    <div class="shape-properties">
      <ShapeStyleEditor v-model="selectedPath.style" />
      <ConnectionPointEditor v-model="connectionPoints" />
    </div>
  </div>
</template>
```

### 4.2 æ•°æ®å»ºæ¨¡å·¥å…·

#### 4.2.1 ERå›¾ç”Ÿæˆå™¨
```typescript
class ERDiagramGenerator {
  generateTable(tableData: TableDefinition): CanvasElement {
    const { name, columns, primaryKeys, foreignKeys } = tableData
    
    // è®¡ç®—è¡¨æ ¼å°ºå¯¸
    const headerHeight = 40
    const rowHeight = 30
    const width = Math.max(200, name.length * 10)
    const height = headerHeight + columns.length * rowHeight
    
    return {
      id: generateId(),
      type: 'database-table',
      geometry: { x: 0, y: 0, width, height, rotation: 0, anchor: 'top-left' },
      style: this.getTableStyle(),
      data: {
        name,
        columns: columns.map(col => ({
          ...col,
          isPrimaryKey: primaryKeys.includes(col.name),
          isForeignKey: foreignKeys.some(fk => fk.column === col.name)
        }))
      },
      connectionPoints: this.generateTableConnectionPoints(width, height),
      metadata: {
        locked: false,
        layerId: 'tables',
        zIndex: 1,
        tags: ['database', 'table']
      }
    }
  }
  
  generateRelationship(source: string, target: string, type: RelationType): Connection {
    return {
      id: generateId(),
      type: 'database-relationship',
      source: { elementId: source, connectionPointId: 'right' },
      target: { elementId: target, connectionPointId: 'left' },
      path: this.calculateRelationshipPath(),
      style: this.getRelationshipStyle(type),
      labels: [{ text: this.getRelationshipLabel(type), position: 0.5 }],
      metadata: { relationshipType: type }
    }
  }
}
```

#### 4.2.2 UMLç±»å›¾ç¼–è¾‘å™¨
```vue
<template>
  <div class="uml-class-editor">
    <div class="class-header">
      <input v-model="classData.name" placeholder="ç±»å" />
      <select v-model="classData.stereotype">
        <option value="">æ— </option>
        <option value="abstract">æŠ½è±¡ç±»</option>
        <option value="interface">æ¥å£</option>
        <option value="enum">æšä¸¾</option>
      </select>
    </div>
    
    <div class="class-attributes">
      <h4>å±æ€§</h4>
      <div v-for="(attr, index) in classData.attributes" :key="index" class="attribute-row">
        <select v-model="attr.visibility">
          <option value="public">+</option>
          <option value="private">-</option>
          <option value="protected">#</option>
        </select>
        <input v-model="attr.name" placeholder="å±æ€§å" />
        <input v-model="attr.type" placeholder="ç±»å‹" />
        <button @click="removeAttribute(index)">åˆ é™¤</button>
      </div>
      <button @click="addAttribute">æ·»åŠ å±æ€§</button>
    </div>
    
    <div class="class-methods">
      <h4>æ–¹æ³•</h4>
      <div v-for="(method, index) in classData.methods" :key="index" class="method-row">
        <select v-model="method.visibility">
          <option value="public">+</option>
          <option value="private">-</option>
          <option value="protected">#</option>
        </select>
        <input v-model="method.name" placeholder="æ–¹æ³•å" />
        <input v-model="method.parameters" placeholder="å‚æ•°" />
        <input v-model="method.returnType" placeholder="è¿”å›ç±»å‹" />
        <button @click="removeMethod(index)">åˆ é™¤</button>
      </div>
      <button @click="addMethod">æ·»åŠ æ–¹æ³•</button>
    </div>
  </div>
</template>
```

### 4.3 æ¨¡æ¿ç³»ç»Ÿ

#### 4.3.1 æ™ºèƒ½æ¨¡æ¿æ¨è
```typescript
class TemplateRecommendationEngine {
  private templates: TemplateDefinition[] = []
  private userHistory: UserAction[] = []
  
  // åŸºäºç”¨æˆ·è¡Œä¸ºæ¨èæ¨¡æ¿
  recommendTemplates(context: RecommendationContext): TemplateRecommendation[] {
    const { currentElements, userIntent, projectType } = context
    
    // åˆ†æå½“å‰ç”»å¸ƒå†…å®¹
    const contentAnalysis = this.analyzeCanvasContent(currentElements)
    
    // åŒ¹é…ç›¸ä¼¼æ¨¡æ¿
    const similarTemplates = this.findSimilarTemplates(contentAnalysis)
    
    // åŸºäºç”¨æˆ·å†å²åå¥½
    const preferredTemplates = this.filterByUserPreferences(similarTemplates)
    
    // è®¡ç®—æ¨èåˆ†æ•°
    return preferredTemplates.map(template => ({
      template,
      score: this.calculateRecommendationScore(template, context),
      reason: this.generateRecommendationReason(template, context)
    })).sort((a, b) => b.score - a.score)
  }
  
  // ç”Ÿæˆè‡ªå®šä¹‰æ¨¡æ¿
  generateTemplateFromSelection(elements: CanvasElement[]): TemplateDefinition {
    return {
      id: generateId(),
      name: this.suggestTemplateName(elements),
      category: this.detectTemplateCategory(elements),
      thumbnail: this.generateThumbnail(elements),
      elements: this.normalizeElements(elements),
      metadata: {
        createdAt: new Date(),
        usage: 0,
        tags: this.extractTags(elements)
      }
    }
  }
}
```

#### 4.3.2 æ¨¡æ¿å¸‚åœº
```vue
<template>
  <div class="template-marketplace">
    <div class="template-categories">
      <div 
        v-for="category in categories" 
        :key="category.id"
        class="category-item"
        :class="{ active: selectedCategory === category.id }"
        @click="selectCategory(category.id)"
      >
        <div class="category-icon">{{ category.icon }}</div>
        <div class="category-name">{{ category.name }}</div>
        <div class="category-count">{{ category.templateCount }}</div>
      </div>
    </div>
    
    <div class="template-grid">
      <div 
        v-for="template in filteredTemplates" 
        :key="template.id"
        class="template-card"
        @click="previewTemplate(template)"
        @dblclick="useTemplate(template)"
      >
        <div class="template-thumbnail">
          <img :src="template.thumbnail" :alt="template.name" />
        </div>
        <div class="template-info">
          <h4>{{ template.name }}</h4>
          <p>{{ template.description }}</p>
          <div class="template-meta">
            <span class="usage-count">{{ template.usage }}æ¬¡ä½¿ç”¨</span>
            <span class="rating">â­ {{ template.rating }}</span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- æ¨¡æ¿é¢„è§ˆ -->
    <TemplatePreviewModal 
      v-if="showPreview"
      :template="previewTemplate"
      @close="showPreview = false"
      @use="useTemplate"
    />
  </div>
</template>
```

## 5. åä½œåŠŸèƒ½è®¾è®¡

### 5.1 å®æ—¶åä½œç¼–è¾‘
```typescript
class CollaborationEngine {
  private websocket: WebSocket
  private operationalTransform: OTEngine
  private conflictResolver: ConflictResolver
  
  // å®æ—¶åŒæ­¥ç”»å¸ƒæ“ä½œ
  syncOperation(operation: CanvasOperation) {
    // æ“ä½œè½¬æ¢
    const transformedOp = this.operationalTransform.transform(operation)
    
    // å‘é€åˆ°æœåŠ¡å™¨
    this.websocket.send(JSON.stringify({
      type: 'canvas-operation',
      operation: transformedOp,
      timestamp: Date.now(),
      userId: this.currentUser.id
    }))
    
    // æœ¬åœ°åº”ç”¨
    this.applyOperation(transformedOp)
  }
  
  // å¤„ç†è¿œç¨‹æ“ä½œ
  handleRemoteOperation(operation: CanvasOperation) {
    // å†²çªæ£€æµ‹
    if (this.conflictResolver.hasConflict(operation)) {
      const resolution = this.conflictResolver.resolve(operation)
      this.applyResolution(resolution)
    } else {
      this.applyOperation(operation)
    }
    
    // æ›´æ–°åä½œè€…å…‰æ ‡
    this.updateCollaboratorCursor(operation.userId, operation.cursor)
  }
}
```

### 5.2 è¯„è®ºå’Œæ‰¹æ³¨ç³»ç»Ÿ
```vue
<template>
  <div class="comment-system">
    <!-- ç”»å¸ƒä¸Šçš„è¯„è®ºæ ‡è®° -->
    <div 
      v-for="comment in canvasComments" 
      :key="comment.id"
      class="comment-marker"
      :style="{ left: comment.x + 'px', top: comment.y + 'px' }"
      @click="openComment(comment)"
    >
      <div class="comment-badge">{{ comment.replies.length + 1 }}</div>
    </div>
    
    <!-- è¯„è®ºé¢æ¿ -->
    <div v-if="activeComment" class="comment-panel">
      <div class="comment-thread">
        <div class="comment-item" v-for="item in commentThread" :key="item.id">
          <div class="comment-author">
            <img :src="item.author.avatar" />
            <span>{{ item.author.name }}</span>
            <time>{{ formatTime(item.createdAt) }}</time>
          </div>
          <div class="comment-content">{{ item.content }}</div>
        </div>
      </div>
      
      <div class="comment-input">
        <textarea v-model="newComment" placeholder="æ·»åŠ è¯„è®º..."></textarea>
        <button @click="addComment">å‘é€</button>
      </div>
    </div>
  </div>
</template>
```

## 6. å¼€å‘ä¼˜å…ˆçº§å’Œæ—¶é—´è§„åˆ’

### Phase 1: å…¨å±ç¼–è¾‘å™¨åŸºç¡€æ¶æ„ (2-3å‘¨)
- [x] è·¯ç”±å’Œé¡µé¢æ¶æ„æ­å»º
- [x] åŸºç¡€å¸ƒå±€ç»„ä»¶ (é¡¶éƒ¨æ ã€å·¦ä¾§æ ã€ç”»å¸ƒã€å³ä¾§æ )
- [x] Konva.js æ¸²æŸ“å¼•æ“é›†æˆ
- [x] åŸºç¡€å·¥å…·ç³»ç»Ÿæ¡†æ¶
- [x] çŠ¶æ€ç®¡ç†æ¶æ„

### Phase 2: æ ¸å¿ƒç»˜å›¾åŠŸèƒ½ (3-4å‘¨)
- [ ] åŸºç¡€å½¢çŠ¶ç»˜åˆ¶ (çŸ©å½¢ã€åœ†å½¢ã€çº¿æ¡)
- [ ] é€‰æ‹©å’Œå˜æ¢å·¥å…·
- [ ] æ–‡æœ¬ç¼–è¾‘åŠŸèƒ½
- [ ] è¿æ¥çº¿ç³»ç»Ÿ
- [ ] æ’¤é”€é‡åšåŠŸèƒ½

### Phase 3: ä¸“ä¸šå›¾å½¢åº“ (3-4å‘¨)
- [ ] æµç¨‹å›¾å½¢çŠ¶åº“
- [ ] æ•°æ®åº“å»ºæ¨¡å·¥å…·
- [ ] UMLå›¾å½¢æ”¯æŒ
- [ ] ç½‘ç»œæ‹“æ‰‘å›¾æ ‡
- [ ] è‡ªå®šä¹‰å½¢çŠ¶ç¼–è¾‘å™¨

### Phase 4: é«˜çº§åŠŸèƒ½ (4-5å‘¨)
- [ ] æ™ºèƒ½è¿æ¥å’Œè‡ªåŠ¨å¸ƒå±€
- [ ] æ¨¡æ¿ç³»ç»Ÿ
- [ ] å¯¼å‡ºåŠŸèƒ½ (PNG/SVG/PDF)
- [ ] åä½œç¼–è¾‘åŸºç¡€
- [ ] è¯„è®ºæ‰¹æ³¨ç³»ç»Ÿ

### Phase 5: ä¼˜åŒ–å’Œé›†æˆ (2-3å‘¨)
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] ç§»åŠ¨ç«¯é€‚é…
- [ ] ä¸ä¸»ç¼–è¾‘å™¨é›†æˆ
- [ ] å…¨é¢æµ‹è¯•
- [ ] æ–‡æ¡£å®Œå–„

## 7. æŠ€æœ¯æŒ‘æˆ˜å’Œè§£å†³æ–¹æ¡ˆ

### 7.1 å¤§è§„æ¨¡å…ƒç´ æ¸²æŸ“æ€§èƒ½
**æŒ‘æˆ˜**: ç”»å¸ƒåŒ…å«æ•°åƒä¸ªå…ƒç´ æ—¶çš„æ¸²æŸ“æ€§èƒ½

**è§£å†³æ–¹æ¡ˆ**:
- è™šæ‹ŸåŒ–æ¸²æŸ“ï¼šåªæ¸²æŸ“å¯è§†åŒºåŸŸçš„å…ƒç´ 
- å›¾å±‚ç¼“å­˜ï¼šé™æ€å…ƒç´ ç¼“å­˜ä¸ºçº¹ç†
- çº§è”æ›´æ–°ï¼šåªæ›´æ–°å˜åŒ–çš„å…ƒç´ 
- Web Workerï¼šå¤§é‡è®¡ç®—ç§»åˆ°åå°çº¿ç¨‹

### 7.2 å®æ—¶åä½œå†²çªè§£å†³
**æŒ‘æˆ˜**: å¤šäººåŒæ—¶ç¼–è¾‘æ—¶çš„æ“ä½œå†²çª

**è§£å†³æ–¹æ¡ˆ**:
- æ“ä½œè½¬æ¢ç®—æ³• (Operational Transformation)
- ç‰ˆæœ¬å‘é‡æ—¶é’ŸåŒæ­¥
- è¯­ä¹‰å†²çªæ£€æµ‹
- ç”¨æˆ·æ„å›¾ä¿æŒç®—æ³•

### 7.3 å¤æ‚å›¾å½¢ç²¾ç¡®äº¤äº’
**æŒ‘æˆ˜**: å¤æ‚è·¯å¾„å’Œå½¢çŠ¶çš„ç²¾ç¡®é€‰æ‹©å’Œç¼–è¾‘

**è§£å†³æ–¹æ¡ˆ**:
- ç¢°æ’æ£€æµ‹ç®—æ³•ä¼˜åŒ–
- å¤šçº§ç²¾åº¦äº¤äº’ (ç²—ç³™ â†’ ç²¾ç¡®)
- æ™ºèƒ½æ•è·åŒºåŸŸ
- ä¸Šä¸‹æ–‡ç›¸å…³çš„äº¤äº’æç¤º

## 8. æ€»ç»“

é€šè¿‡å¯¹é£ä¹¦ç”»æ¿çš„æ·±å…¥åˆ†æï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€å¥—å®Œæ•´çš„å…¨å±ç”»æ¿ç¼–è¾‘ç³»ç»Ÿã€‚æ ¸å¿ƒç‰¹ç‚¹åŒ…æ‹¬ï¼š

1. **ç‹¬ç«‹å…¨å±ç¼–è¾‘ä½“éªŒ**: é€šè¿‡è·¯ç”±è·³è½¬æä¾›æ²‰æµ¸å¼ç¼–è¾‘ç¯å¢ƒ
2. **ä¸“ä¸šå·¥å…·ç”Ÿæ€**: ä¸°å¯Œçš„å½¢çŠ¶åº“å’Œä¸“ä¸šç»˜å›¾å·¥å…·
3. **æ™ºèƒ½äº¤äº’ç³»ç»Ÿ**: è‡ªåŠ¨å¸é™„ã€æ™ºèƒ½è·¯ç”±ã€æ‰¹é‡æ“ä½œ
4. **é«˜æ€§èƒ½æ¸²æŸ“**: åŸºäºKonva.jsçš„ä¼˜åŒ–æ¸²æŸ“å¼•æ“
5. **åä½œç¼–è¾‘æ”¯æŒ**: å®æ—¶åŒæ­¥å’Œå†²çªè§£å†³æœºåˆ¶

è¿™ä¸ªè®¾è®¡æ–¹æ¡ˆæ—¢ä¿æŒäº†ä¸ç°æœ‰æ¶æ„çš„å…¼å®¹æ€§ï¼Œåˆæä¾›äº†ä¸“ä¸šçº§çš„ç”»æ¿ç¼–è¾‘ä½“éªŒï¼Œèƒ½å¤Ÿæ»¡è¶³å„ç§å¤æ‚çš„ç»˜å›¾éœ€æ±‚ã€‚ 